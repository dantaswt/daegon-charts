// --- NOVA LÓGICA DE BUSCA DE IMAGEM (MAIS SIMPLES E COM DIAGNÓSTICO) ---
        async function getArtworkImage(artist, name, type) {
            // Adiciona logs para vermos o que está sendo buscado para cada item
            console.log(`Buscando imagem para: [Tipo: ${type}, Artista: ${artist}, Título: ${name || 'N/A'}]`);

            // Para álbuns ou músicas, a prioridade é a capa do álbum
            if (type === 'album' || type === 'song') {
                // Tenta buscar a capa do álbum no The AudioDB
                const albumArtUrl = await getArtFromAudioDB(artist, name, 'album');
                if (albumArtUrl) {
                    console.log(`-> Encontrado (Capa de Álbum): ${albumArtUrl}`);
                    return albumArtUrl;
                }
            }

            // Se for um artista, ou se a busca pela capa do álbum falhar, busca a foto do artista
            const artistArtUrl = await getArtFromAudioDB(artist, null, 'artist');
            if (artistArtUrl) {
                console.log(`-> Encontrado (Foto do Artista): ${artistArtUrl}`);
                return artistArtUrl;
            }

            // Se nada for encontrado, retorna 'not_found'
            console.log('-> Nenhuma imagem encontrada em nenhuma fonte.');
            return 'not_found';
        }

        async function getArtFromAudioDB(artist, name, searchType) {
            try {
                let url = '';
                if (searchType === 'album') {
                    url = `https://www.theaudiodb.com/api/v1/json/2/searchalbum.php?s=${encodeURIComponent(artist)}&a=${encodeURIComponent(name)}`;
                } else { // 'artist'
                    url = `https://www.theaudiodb.com/api/v1/json/2/search.php?s=${encodeURIComponent(artist)}`;
                }

                const response = await fetch(url);
                if (!response.ok) return null;
                const data = await response.json();
                
                if (searchType === 'album') {
                    return data?.album?.[0]?.strAlbumThumb || null;
                } else { // 'artist'
                    return data?.artists?.[0]?.strArtistThumb || null;
                }
            } catch (error) {
                console.error(`Erro ao buscar no TheAudioDB para [${artist}|${name}]:`, error);
                return null;
            }
        }